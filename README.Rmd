---
title:  "Project **Brazilian Reefs in the Anthropocene**, Reef Synthesis Working Group  (ReefSYN)"
author: "ReefSYN, Luza, AL, Cordeiro, CAMM, ..., Ferreira, CEL, Mendes, T., Francini-Filho, RB, Longo, GO, Floeter, SR, Bender, MG"
date: "2022/07/07"
output: github_document
---


<!-- README.md is generated from README.Rmd. Please edit that file -->

<!-- badges: start -->
<!-- badges: end -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Paper section 1: Who are we?

The leveraging of ecological synthesis has two main reasons: ecology is entering in the age of big data (Wuerst et al. 2020, GEB) and applying the principles of open science (UNESCO 2020). We are now experiencing a transition from isolated research, with data stored in the drawer, to a global research network with data stored in public repositories available to be used to leverage further research (Reich et al. 2011). Brazil just started to go in this direction, with recent initiatives such as the LattesData (CNPq) and the Brazilian Institute of Synthesis (Sinbiose, see <http://www.sinbiose.cnpq.br/web/sinbiose/home>), both comprising pioneer initiatives in South America in terms of data storage capability and application of open-science principles (UNESCO 2020). There are seven working groups funded by the Sinbiose institute, being the ReefSYN--Reef Synthesis Working Group--the only group working with marine ecosystems (particularly coral and rocky reefs).

The ReefSYN is a team of researchers from several countries and institutions, interested in several dimensions of reef biodiversity and associated ecosystem services (Fig. 1). Our team is specially engaged in achieving a common objective: *To provide a synthesis about patterns and drivers of reef diversity and supplying of ecological services in Brazil*. More information about our group can be found at <https://reefsyn.weebly.com/home-us.html>.


```{r, echo = F, fig.height=6.5,fig.width=6.5,fig.margin=F,fig.align="center", message=F,warning=F,out.width="100%",out.height="100%"}


## R code to load data sets and plot points
## call packages

source("R/packages.R")
source("R/functions.R")



# open researcher data
researcher_data <- read.xlsx(here("Data","researcher_data","PLANILHA_CONSOLIDADA.xlsx"),sheet = 1, colNames = TRUE,detectDates=F)
# formatting data
researcher_data$objetivos <- as.character (researcher_data$objetivos)
researcher_data$titulo_portugues <- as.character (researcher_data$titulo_portugues)
researcher_data$titulo_ingles <- as.character (researcher_data$titulo_ingles)

## extrair as colunas que desejo analaisar
institution <- strsplit(researcher_data$instituicao,",")
institution <- unlist(strsplit(unlist(institution), "/"))
institution <- gsub (" ","",institution)
# df for word-cloud
institution <- data.frame (inst=unique(institution) [order (unique(institution))],
                           freq=table(institution) [order (names(table(institution)))])

### titulo em ingles
titulo_ingles <- as.character (researcher_data$titulo_ingles [which(researcher_data$titulo_ingles != "Indefinido")])
## gerar df para o wcloud
freq_texto_wc <-  function_freq_texto_wc (titulo_ingles)

par(mfrow=c(1,2),mar=rep(0, 4))
## inst
wordcloud(words = institution$inst, freq = institution$freq.Freq,
          min.freq = 1,scale=c(4, .2),
          max.words=50, 
          random.order=FALSE, rot.per=0.15, 
          colors=brewer.pal(8, "Dark2"))

# tit english
wordcloud(words = freq_texto_wc$word, 
          freq = freq_texto_wc$freq.Freq,
          min.freq = 2,scale=c(4, .2),
          max.words=max(freq_texto_wc$freq.Freq)+3, 
          random.order=FALSE, rot.per=0.15, 
          colors=brewer.pal(8, "Dark2"))



```
Fig. 1: Institutions and research topics explored by the ReefSYN team members.


# Paper section 2: Spatial distribution of spatial and temporal data gathered by the ReefSYN Working Group

Natural to ecological synthesis is the use of big data (both in terms of amount of data and heterogeneity on data). To achieve our objective, we are analyzing data from almost 400 unique localities distributed along the Brazilian coast and oceanic islands, embracing from 0.91 to -27.6 latitude degrees. In these localities, we gathered already published and yet unpublished data of fish and benthic communities --generated by geographically replicated, large-scale research programs conducted over the last decades in Brazilian coast and oceanic islands (SISBOTA-MAR, PELD-ILOC, or yet personal, novel initiatives such as the monitoring of reef fish and benthos of Rio Grande do Norte and Abrolhos Bank).  We also have data collected beyond the Brazilian coast (e.g., Longo et al. 2019, GEB), and a species-level trait Dataset that includes Atlantic and Eastern Pacific fishes (Quimbayo et al., 2021). Below we present the map with the spatial distribution of localities included in fish and benthic datasets. 




```{r, echo = F, fig.height=5,fig.width=8,message=F, warning=F, fig.align= "center",out.width="100%",out.height="100%"}

# load Datasets
# benthos

ds1<- read.csv (here("DwC_output","AAued_spatialData", "event_core.csv"))
ds2<- read.csv (here("DwC_output","GLongo_NRoss_spatialData", "event_core_benthos.csv"))
ds3<- read.table (here("DwC_output","PELD_iloc_benthos", "event_core.txt"),h=T,sep=",")
colnames(ds3)[which(colnames(ds3) == "island")] <- "site"
colnames(ds3)[which(colnames(ds3) == "eventYear")] <- "year"
ds3$higherGeography <- "BrazilianOceanicIslands"
ds4<- read.csv (here("DwC_output","RFrancini_spatialData", "event_core.csv"))
ds5<- read.csv (here("DwC_output","RFrancini_timeSeries_abrolhos","event_core_benthos.csv"))

# fish

ds6<- read.csv (here("DwC_output","GLongo_NRoss_spatialData", "event_core_fish.csv"))
ds7<- read.csv (here("DwC_output","GLongo_spatialData", "event_core.csv"))
ds8<- read.table (here("DwC_output","PELD_iloc_fish", "event_core.txt"),h=T, sep= ";")
colnames(ds8)[which(colnames(ds8) == "island")] <- "site"
colnames(ds8)[which(colnames(ds8) == "eventYear")] <- "year" # 
ds8 <- ds8 [which(ds8$site != "Ascension"),] # removing Ascension
ds8$higherGeography <- "BrazilianOceanicIslands"
ds9<- read.csv (here("DwC_output","RFrancini_timeSeries_abrolhos","event_core_fish.csv"))
ds10<- read.csv (here("DwC_output","RJ_time_series", "event_core.csv"))
ds11<- read.csv (here("DwC_output","RMorais_spatialData", "event_core.csv"))
ds12<- read.csv (here("DwC_output","SC_time_series", "event_core.csv"))



# list of sites with sampling of benthic communities
list_benthos <- list(data.frame (ds1, Dataset= "Sisbiota-Mar"),
                     data.frame (ds2, Dataset="RN monitoring"),
                     data.frame (ds3, Dataset ="PELD ILOC"),
                     data.frame (ds4, Dataset = "Coastal snapshots"),
                     data.frame (ds5, Dataset = "Abrolhos Bank"))



# agggregate and get coordinates for each site
require(dplyr)
coords <- lapply (list_benthos, function (i) 
  
  
  dplyr::group_by(i,Dataset,higherGeography, site, locality) %>% 
  
                    summarise(decimalLatitude = mean( decimalLatitude),
                            decimalLongitude = mean( decimalLongitude)) %>% 
    
                  select (higherGeography,site, locality,
                          decimalLatitude,decimalLongitude)
)

# melt
coords <- do.call(rbind,coords)


# map
# mapa mundi
world <- ne_countries(scale = "medium", returnclass = "sf")

# cortar o mapa para ver a america do Sul e parte da central
wm <- ggplot() + 
  geom_sf (data=world, size = 0.1, 
           fill= "gray90",colour="gray90") +
  coord_sf (xlim = c(-50, -25),  ylim = c(-30, 4), expand = FALSE) +
  theme_bw() + xlab ("Longitude")  + ylab ("Latitude") +
  theme(panel.border = element_blank(), 
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "lightcyan",#darkslategray1
                                        colour = "lightcyan"),
        
        axis.text.x = element_text(size=6),
        axis.ticks.x=element_line(size=1),
        axis.text.y = element_text(size=6),
        axis.ticks.y=element_line(size=1),
        axis.title.x = element_text(size=8),
        axis.title.y = element_text(size=8),
        title = element_text(size=9)) 

# map
wm_data <- wm +  geom_jitter(data = coords, 
                             aes(x = decimalLongitude, 
                                 y = decimalLatitude,
                                 col = Dataset,
                                 fill=Dataset), 
                            size =4, position= "jitter",
                            stat = "identity",
        shape = 19, alpha=0.3) +
  theme (plot.background = element_rect("#EBEBEB"),
        #panel.background = element_blank(),
        axis.title = element_text(color = "#292929", face = "bold"),
        axis.text = element_text(color = "#292929", face = "bold"),
         legend.text = element_text(size =6),
        legend.title = element_text(size =7),
        legend.key.height= unit(0.3, 'cm'),
        legend.key.width= unit(0.1, 'cm'),
        panel.grid = element_blank())+
  scale_colour_viridis_d(option="magma", end=0.8)+
  ggtitle (paste ("Data of benthic communities", "n=", nrow(coords), sep=" "))  +
  guides(colour = guide_legend(override.aes = list(alpha=1)))


# ================
# fish

list_fish <- list(data.frame (ds6, Dataset = "RN monitoring"),
                  data.frame (ds7, Dataset = "Sisbiota-Mar (VP)"),
                  data.frame (ds8, Dataset = "PELD ILOC"),
                  data.frame (ds9, Dataset = "Abrolhos Bank"),
                  data.frame (ds10, Dataset = "Arraial do Cabo"),
                  data.frame (ds11, Dataset = "Sisbiota-Mar (UVC)"),
                  data.frame (ds12, Dataset = "Santa Catarina"))


# agggregate and get coordinates for each site
coords_fish <- lapply (list_fish, function (i) 
  
  
  group_by(i,Dataset, higherGeography, site, locality) %>% 
  
                    summarise(decimalLatitude = mean( decimalLatitude,na.rm=T),
                            decimalLongitude = mean( decimalLongitude,na.rm=T)) %>% 
    
                  select (higherGeography,site, locality,
                          decimalLatitude,decimalLongitude)
)

# melt
coords_fish <- do.call(rbind,coords_fish)


# map
wm_data_fish <- wm +  geom_point(data = coords_fish, aes(x = decimalLongitude, 
                                                         y = decimalLatitude,
                                                         col = Dataset,
                                                         fill=Dataset), 
                            size =4, position= "jitter",
        shape = 19, alpha=0.3) + 
  scale_colour_viridis_d(direction=1)+
  theme (plot.background = element_rect("#EBEBEB"),
        #panel.background = element_blank(),
        axis.title = element_text(color = "#292929", face = "bold"),
        axis.text = element_text(color = "#292929", face = "bold"),
        legend.text = element_text(size =6),
        legend.title = element_text(size =7),
        legend.key.height= unit(0.3, 'cm'),
        legend.key.width= unit(0.1, 'cm'),
        panel.grid = element_blank())+
  ggtitle (paste ("Data of fish commnities", "n=", nrow(coords_fish), sep=" ")) +
  guides(colour = guide_legend(override.aes = list(alpha=1))) 


grid.arrange(wm_data,
             wm_data_fish,ncol=2)



      

```
Fig. 2: Spatial distribution of sampling sites of benthos (right) and fish (left) per dataset.


# Paper section 3: Temporal trends on data acquisition

The number of eventIDs per Dataset (five independent Datasets)

```{r, echo = F, fig.height=5,fig.width=8,message=F, warning=F,fig.align= "center",out.width="100%",out.height="100%"}

# benthos
# number of eventIDs (rows per year)
eventIDs_year <- lapply (list_benthos, function (i) i %>% 
                           group_by (year,Dataset) %>% 
                           tally()  # the number of eventIDs
                         
                         )
# count the ids
eventIDs_year_benthos<-do.call(rbind,eventIDs_year) %>%
                           
                          group_by(year) %>%
                           
                          summarise (sum_cum = sum (n)) %>% # sum the number of ids per year
                          mutate(n_cum = cumsum(sum_cum)) # find the cumulative sum

# the beggining of each Dataset
begin_data <- do.call(rbind,eventIDs_year) %>%
                           
                          group_by(Dataset) %>%
                          
                          summarise (min_year = min (year,na.rm=T)) 


# fish
# number of eventIDs (rows per year)
eventIDs_yearB <- lapply (list_fish, function (i) i %>% 
                           group_by (year,Dataset) %>% 
                           tally()  # the number of eventIDs
                         
                         )
# count the ids
eventIDs_year_fish<-do.call(rbind,eventIDs_yearB) %>%
                           
                          group_by(year) %>%
                           
                          summarise (sum_cum = sum (n)) %>% # sum the number of ids per year
                          mutate(n_cum = cumsum(sum_cum)) # find the cumulative sum

# the beggining of each Dataset
begin_data_fish <- do.call(rbind,eventIDs_yearB) %>%
                           
                          group_by(Dataset) %>%
                          
                          summarise (min_year = min (year,na.rm=T)) 


# bind the years in the fish Dataset missing in the benthic Datasets
to_bind_benthos <- data.frame (year = c(2001, 2002,2020,2021,2022),
                               sum_cum=c(0,0,max(eventIDs_year_benthos$sum_cum),
                                          max(eventIDs_year_benthos$sum_cum),
                                          max(eventIDs_year_benthos$sum_cum)),
                               n_cum=c(0,0,max(eventIDs_year_benthos$n_cum),
                                       max(eventIDs_year_benthos$n_cum),
                                       max(eventIDs_year_benthos$n_cum)))

# bind
eventIDs_year_benthos <- bind_rows (eventIDs_year_benthos,
                                    to_bind_benthos) %>% 
  
              arrange (year)


# plot 
# benthos
trend_benthos <- ggplot (data = eventIDs_year_benthos, aes (x=year,y=n_cum)) + 
  geom_area(alpha=0.5, fill = "#FD8235", col = "gray30",size=2) + 
  theme(plot.background = element_rect("#EBEBEB"),
        panel.background = element_blank(),
        axis.title = element_text(color = "#292929", face = "bold"),
        axis.text = element_text(color = "#292929", face = "bold"),
        panel.grid = element_blank()) + 
  xlab ("") + ylab ("") 

trend_benthos_annotate <- trend_benthos + geom_text(data = begin_data, aes (x= min_year, y = 2500,
                                                  label = Dataset,
                                                  angle = 270),
                                                  size = 3) + 
  geom_segment(data = begin_data, 
               aes(x = min_year, y = 0, xend = min_year, yend = 1500)) + 
  geom_segment(aes(x = 2011, y = -100, xend = 2014, yend = -100),size=3,col="gray30")+
  geom_segment(aes(x = 2013, y = 100, xend = 2022, yend = 100),size=3,col="gray60")+
  geom_segment(aes(x = 2020, y = 300, xend = 2022, yend = 300),size=3,col="#5A8F7B")

# fish
trend_fish <- ggplot (data = eventIDs_year_fish, aes (x=year,y=n_cum)) + 
  geom_area(alpha=0.5, fill = "#6CC4A1", col = "gray30",size=2) + 
  theme(plot.background = element_rect("#EBEBEB"),
        panel.background = element_blank(),
        axis.title.y = element_text(color = "#292929", face = "bold"),
        axis.text.y = element_text(color = "#292929", face = "bold"),
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),# element_text(color = "#292929", face = "bold"),
        panel.grid = element_blank()) + 
  xlab ("") + ylab ("") 

trend_fish_annotate <- trend_fish + geom_text_repel(data = begin_data_fish, aes (x= min_year, y = 15000,
                                                  label = Dataset,
                                                  angle = 270),
                                                  size = 3,
                                                  box.padding=0) + 
  geom_segment(data = begin_data_fish, 
               aes(x = min_year, y = 0, xend = min_year, yend = 10000)) +
   geom_segment(aes(x = 2011, y = -400, xend = 2014, yend = -400),size=3,col="gray30")+
  geom_segment(aes(x = 2013, y = 500, xend = 2022, yend = 500),size=3,col="gray60")+
  geom_segment(aes(x = 2020, y = 1300, xend = 2022, yend = 1300),size=3,col="#5A8F7B")+
  
  scale_y_reverse()


grid.arrange (trend_benthos_annotate,
              trend_fish_annotate,
              nrow=2,
              left = "Cumulative number of sampling events (eventIDs)") 




```
Fig. 3: The number of sampling events accumulated over time. One sampling event consist, for example, on one transect deployed into a locality. The vertical segments depict the year in which data included in each Dataset started to be collected. The horizontal bars depict the formal funding as follows: dark gray bar: Sisbiota, CNPq; light gray bar: PELD, CNPq; green bar: ReefSYN, Sinbiose CNPq. 


# Paper section 4: Temporal trends on the number of species


```{r, echo = F, fig.height=5,fig.width=8,message=F, warning=F, fig.align= "center",out.width="100%",out.height="100%"}

# load Datasets
# benthos
ds1_occ<- read.csv (here("DwC_output","AAued_spatialData", "DF_occ.csv"))
ds1_occ$year<- ds1 [match (ds1_occ$eventID, ds1$eventID), "year"]
ds2_occ<- read.csv (here("DwC_output","GLongo_NRoss_spatialData", "DF_occ_benthos.csv"))
ds2_occ$year<- ds2 [match (ds2_occ$eventID, ds2$eventID), "year"]
ds3_occ<- read.table (here("DwC_output","PELD_iloc_benthos", "DF_occ.txt"),sep = ",",h=T)
ds3_occ$year<- ds3 [match (ds3_occ$eventID, ds3$eventID), "year"]
colnames(ds3_occ)[which(colnames(ds3_occ) == "island")] <- "site"
colnames(ds3_occ)[which(colnames(ds3_occ) == "eventYear")] <- "year"
ds3_occ$higherGeography <- "BrazilianOceanicIslands"
ds4_occ<- read.csv (here("DwC_output","RFrancini_spatialData", "DF_occ.csv"))
ds4_occ$year<- ds4 [match (ds4_occ$eventID, ds4$eventID), "year"]
ds5_occ<- read.csv (here("DwC_output","RFrancini_timeSeries_abrolhos","DF_occ_benthos.csv"))
ds5_occ$year<- ds5 [match (ds5_occ$eventID, ds5$eventID), "year"]

# fish

ds6_occ<- read.csv (here("DwC_output","GLongo_NRoss_spatialData", "DF_occ_fish.csv"))
ds6_occ$year<- ds6 [match (ds6_occ$eventID, ds6$eventID), "year"]
ds7_occ<- read.csv (here("DwC_output","GLongo_spatialData", "DF_occ.csv"))
ds7_occ$year<- ds7 [match (ds7_occ$eventID, ds7$eventID), "year"]
ds8_occ<- read.table (here("DwC_output","PELD_iloc_fish", "DF_occ.txt"),h=T, sep = ";")
ds8_occ$higherGeography <- "BrazilianOceanicIslands"
ds8_occ$year<- ds8 [match (ds8_occ$eventID, ds8$eventID), "year"]
ds9_occ<- read.csv (here("DwC_output","RFrancini_timeSeries_abrolhos","DF_occ_fish.csv"))
ds9_occ$year<- ds9 [match (ds9_occ$eventID, ds9$eventID), "year"]
ds10_occ<- read.csv (here("DwC_output","RJ_time_series", "DF_occ.csv"))
ds10_occ$year<- ds10 [match (ds10_occ$eventID, ds10$eventID), "year"]
ds11_occ<- read.csv (here("DwC_output","RMorais_spatialData", "DF_occ.csv"))
ds11_occ$year<- ds11 [match (ds11_occ$eventID, ds11$eventID), "year"]
ds12_occ<- read.csv (here("DwC_output","SC_time_series", "DF_occ.csv"))
ds12_occ$year<- ds12 [match (ds12_occ$eventID, ds12$eventID), "year"]



# list of sites with sampling of benthic communities
list_occ_benthos <- list(data.frame (ds1_occ, Dataset= "Sisbiota-Mar"),
                     data.frame (ds2_occ, Dataset="RN monitoring"),
                     data.frame (ds3_occ, Dataset ="PELD ILOC"),
                     data.frame (ds4_occ, Dataset = "Coastal snapshots"),
                     data.frame (ds5_occ, Dataset = "Abrolhos Bank")
                     )



# ================
# fish

list_occ_fish <- list(data.frame (ds6_occ, Dataset = "RN monitoring"),
                  data.frame (ds7_occ, Dataset = "Sisbiota-Mar (VP)"),
                  data.frame (ds8_occ, Dataset = "PELD ILOC"),
                  data.frame (ds9_occ, Dataset = "Abrolhos Bank"),
                  data.frame (ds10_occ, Dataset = "Arraial do Cabo"),
                  data.frame (ds11_occ, Dataset = "Sisbiota-Mar (UVC)"),
                  data.frame (ds12_occ, Dataset = "Santa Catarina"))





## project richness
# benthos
# number of spp year (rows per year)
library(tidyr)
library(dplyr)
require(reshape2)
require(magrittr)

spp_year <- do.call(rbind ,
                    
                    lapply (list_occ_benthos, function (i)  
                      
                    
                        i %>% select (year,scientificName,Dataset) # interesting columns
  
                              
                       )) %>% 
  
                dcast (formula = year  ~scientificName, # table
                                  drop=T) %>%
                        
                  
                  set_rownames(.$year)   # set rownames

                    
                

# composition matrix
spp_year <-  ifelse (spp_year >=1,1,0)
spp_year <- spp_year [,-which(colnames(spp_year) == "NA")]# rm NA cols

# aggregate
agg_data_year1 <- sum (spp_year[1,-1]>0)
acc_time <- lapply (seq (2,nrow(spp_year)), function (i){
  
        agg_data <- aggregate (
               data.frame (spp_year[1:i,]), 
                   by = list (spp_year[1:i,"year"]),
                   FUN = sum)[,-c(1,2)]
        sum_sp <- sum (agg_data>0)
        sum_sp
})
acc_time<- c(agg_data_year1, unlist(acc_time))
acc_time <- data.frame(SR = acc_time, 
           year = as.numeric(rownames(spp_year)))
acc_time<-rbind (acc_time,
                 data.frame  (SR=max(acc_time$SR), 
                              year=c(2020,2021,2022)))

# fish 

spp_year_fish <- do.call(rbind ,
                    
                    lapply (list_occ_fish, function (i)  
                      
                    
                        i %>% select (year,scientificName,Dataset) # interesting columns
  
                              
                       )) %>% 
  
                dcast (formula = year  ~scientificName, # table
                                  drop=T)# %>%
                        
                  
                 # set_rownames(.$year)   # set rownames

                    
                

# composition matrix
spp_year_fish <-  ifelse (spp_year_fish >=1,1,0)
spp_year_fish <- spp_year_fish [,-which(colnames(spp_year_fish) == "NA")]# rm NA cols

# aggregate
agg_data_year1_fish <- sum (spp_year_fish[1,-1]>0)
acc_time_fish <- lapply (seq (2,nrow(spp_year_fish)), function (i){
  
        agg_data <- aggregate (
               data.frame (spp_year_fish[1:i,]), 
                   by = list (spp_year_fish[1:i,"year"]),
                   FUN = sum)[,-c(1,2)]
        sum_sp <- sum (agg_data>0)
        sum_sp
})
acc_time_fish<- c(agg_data_year1_fish, unlist(acc_time_fish))
acc_time_fish <- data.frame(SR = acc_time_fish, 
           year = seq (2000,2022))
#acc_time_fish$year <- as.Date(as.character(acc_time_fish$year), format = "%Y")


# plot 
# benthos
trend_benthos_SR <- ggplot (data = acc_time, 
                            aes (x= (year),y=SR)) + 
  geom_area(alpha=0.5, fill = "#FD8235", col = "gray30",size=2) + 
  theme(plot.background = element_rect("#EBEBEB"),
        panel.background = element_blank(),
        axis.title = element_text(color = "#292929", face = "bold"),
        axis.text = element_text(color = "#292929", face = "bold"),
        panel.grid = element_blank()) + 
  xlab ("") + ylab ("") +
  
  # projects 
  geom_text_repel(data = begin_data, aes (x= min_year, y = 100,
                                                  label = Dataset,
                                                  angle = 270),
                                                  size = 3,
                                                  box.padding=0) + 
  geom_segment(data = begin_data, 
               aes(x = min_year, y = 0, xend = min_year, yend = 80)) + 
  
  # grants
  geom_segment(aes(x = 2011, y = -5, xend = 2014, yend = -5),size=3,col="gray30")+
  geom_segment(aes(x = 2013, y = 4, xend = 2022, yend = 4),size=3,col="gray60")+
  geom_segment(aes(x = 2020, y = 12, xend = 2022, yend = 12),size=3,col="#5A8F7B")

# fish
trend_fish_SR <- ggplot (data = acc_time_fish, aes (x=year,y=SR)) + 
  geom_area(alpha=0.5, fill = "#6CC4A1", col = "gray30",size=2) + 
  theme(plot.background = element_rect("#EBEBEB"),
        panel.background = element_blank(),
        axis.title.y = element_text(color = "#292929", face = "bold"),
        axis.text.y = element_text(color = "#292929", face = "bold"),
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),# element_text(color = "#292929", face = "bold"),
        panel.grid = element_blank()) + 
  xlab ("") + ylab ("") +
  
  scale_y_reverse() + 
  # projects
  geom_text_repel(data = begin_data_fish, aes (x= min_year, y = 300,
                                                  label = Dataset,
                                                  angle = 270),
                                                  size = 3,
                                                  box.padding=0) + 
  geom_segment(data = begin_data_fish, 
               aes(x = min_year, y = 0, xend = min_year, yend = 300)) + 
  
  # grants
  geom_segment(aes(x = 2011, y = -10, xend = 2014, yend = -10),size=3,col="gray30")+
  geom_segment(aes(x = 2013, y = 13, xend = 2022, yend = 13),size=3,col="gray60")+
  geom_segment(aes(x = 2020, y = 40, xend = 2022, yend = 40),size=3,col="#5A8F7B")


# arrange plots
grid.arrange(trend_benthos_SR,
             trend_fish_SR,
             nrow=2,
              left = "Cumulative number of scientificNames")


```


# Paper section 5: Brief description of each data set

## Spatial data

### Fish communities from the Brazilian province
This Dataset, used by Morais et al. 2017 (Journal of Fish Biology), includes fish counts in 4,570 transects distributed over 137 sites in 20 different localities from 0 to 27°S latitude degrees (including oceanic islands). The Dataset includes fish counts and size estimates. Sampling descriptors include Observer ID, site depth, and date. The geographical information is at the site (not transect) level. Data and metadata are available [here](https://drive.google.com/drive/u/0/folders/1Wn4n66sVPoj3YBT1kGFUE2FuMyPq4Iic). These data were generated by the team of [SISBIOTA Mar project](http://www.sisbiota.ufsc.br/). All documentation describing the edits in this Dataset (for use of the ReefSYN) can be found [here] ().


### Benthic communities from the Brazilian province
This Dataset, used by Aued et al. 2018 (PlosOne) [data also published at ?????], includes the cover of benthic organisms into 3,855 photoquadrats deployed in 40 sites in 15 different localities from 0 to 27°S latitude degrees. Benthic organisms were identified at several taxonomic levels (morphotype, species, order). Sampling descriptors include photoquadrat ID, site depth, date and, for some samples, observer ID. The geographical information is at the site (not transect) level. Data and metadata are available [here](https://drive.google.com/drive/u/0/folders/1sgILttlP6HQ1KOHV5yuyQouLe6Pscjlj). These data were generated by the team of [SISBIOTA Mar project](http://www.sisbiota.ufsc.br/).


### Benthic communities from the Brazilian province (Ronaldo Francini-Filho)
This dataset was compiled by Erika Santana, Anaíde Aued, and Ronaldo Francini-Filho, and consists in data of benthic organisms sampled in photoquadrats deployed in several sites disposed along the coast and oceanic islands. Benthic organisms were identified at several taxonomic levels (morphotype, species, order). The dataset originally had environmental descriptors such as site depth, month and year (not in  DwC standard). Data and metadata are available [here](https://drive.google.com/drive/u/0/folders/1o0S5-u1GAPSLwg8P5zzl11xzx4X5pxIU).

### Trophic interactions along the Western Atlantic
This Dataset, used by Longo et al. 2019 (Global Ecology and Biogeograhy), includes records of the interactions between fishes and benthic organisms. These data were obtained with 1,133 unique videoplots deployed in 70 sites in 17 different localities from 34°N to 27°S. Sampling descriptors include recording time, date, depth, and observed ID. No geographical information besides site ID is available. Data and metadata are available [here](https://drive.google.com/drive/u/0/folders/126xLZ6Z3xKO_pIT1IfGNj268Qy7E_Lo7). 

### Fish and benthic communities from Rio Grande do Norte
Data collected by Guilherme Longo and Natália Roos in Rio Grande do Norte. Data of fishes and benthos were collected in the same spatial unit: within a transect of 20m2 used to register fishes, they deployed 10 photoquadrats to register benthic organisms. These data were used by N Roos [Roos et al. 2019](https://www.int-res.com/prepress/m13005.html) and are available [here](https://drive.google.com/drive/u/0/folders/1WG68D_QAPKIZbZhYZmFOenOdUjejnjXn).

## Temporal data
### Benthic communities from oceanic islands
Two Datasets of benthic communities registered in the Fernando de Noronha Archipelago and Rocas Atoll from 2013 to 2018. These data were shared by Sérgio Floeter are are available [here](https://drive.google.com/drive/u/0/folders/1DXrcYH3yCbknkEuqpGG59m89LbDJpzVJ). Data from Trindade Island and Martiz Vaz Archipelago, Abrolhos, and Saint Peter and Saint Paul's Archipelago will be available soon. These data were generated by the team of [PELD ILOC project](http://peldiloc.sites.ufsc.br/).

## Trait data
### Atlantic and Eastern Pacific fishes
Unpublished data collected by Juan Pablo Quimbayo and collaborators. These data include functional traits of 2,153 fish species. Traits describe activity, size, diet, distribution, and fishing price. Data and metadata can be found [here](https://drive.google.com/drive/u/0/folders/1aG6zlU5uoeLEPwwdnRKoTAqvldBmyJsp).

### Benthos from the Brazilian province
Unpublished data collected by Anaide Aued and collaborators. These data include functional traits of more than 100 taxa of benthic organisms. Traits describe mobility, size, growth form, trophic level, and accretion capacity. Data and metadata can be found [here](https://drive.google.com/drive/u/0/folders/1H54FZnBRwdF-ZdDkJ7hjB4ZnyBULspV8).

### Corals of the Brazilian province 
Unpublished data collected J Bleuel and collaborators. These data include functional traits of 24 coral species. Traits describe reproduction mode and period, growth rate and form, and tolerance to depth, light, and temperature. These data can be found [here](https://drive.google.com/drive/u/0/folders/1vQp0xz_AMqepVbg1sbrFk1lvsjo_ecYL).    

## Spatial polygons
We are using the most updated, yet unpublished spatial data of marine protected and priority areas (year 2018), from Brazilian Institute for Biodiversity Conservation ('ICMBIO'). These data contain six shapefiles with spatial data about conservation priority areas, artisanal fishing, and implementation cost, urgency, and opportunity. These data were produced by the team of AP Prates, were shared by Carlos Eduardo Ferreira, and can be found [here](https://drive.google.com/drive/u/0/folders/1Xra9owUYi0dK_T4l8WEn-aH7QnTk6ZtH).


```{r,fig.height=7, fig.width=7, echo= F,message=F,warning=F, highlight=F, results= "hide"}



```

## Brazilian Protected Areas

Finally, we have spatial data on Brazilian Protected Areas that can be used in many steps of the project. These spatial data were shared by Rafael Magris (ICMBio) and can be found [here] ().

## How can you access these data?

Published data can be found at their on-line repositories. Unpublished data are only available to ReefSyn members, as defined by our "Policy of data sharing and use" (available [here](https://github.com/Sinbiose-Reefs/reefsyn_site/blob/master/DataPolicy_SINBIOSE.pdf)). We will let these data available to external users at **January 2023**, one year after the end of the ReefSyn project. If you are a member of the ReefSyn team, please read our [co-authoring rules](https://github.com/Sinbiose-Reefs/reefsyn_site/blob/master/Coauthor_SINBIOSE.pdf).
  
### Grant

This project is granted by the Brazilian Biodiversity Synthesis Center - [SINBIOSE](http://www.sinbiose.cnpq.br/web/sinbiose). This center belongs to the National Council for Scientific and Technological Development (*Conselho Nacional de Desenvolvimento Científico e Tecnológico*, CNPq).  
    
    
    
    
**ReefSYN Working Group**  
  
  


